!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.echartsBuilder=t():e.echartsBuilder=t()}(self,(()=>(()=>{"use strict";var e={};const t={cacheTimeout:3e5,clearCacheSpace:6e4},r=new Map,n=new Map;let s=0;function i(){return s+t.clearCacheSpace>Date.now()?Promise.resolve(!0):(s=Date.now(),new Promise((e=>{for(const[e,n]of r.entries())n.timestamp+t.cacheTimeout<=Date.now()&&r.delete(e);e(!0)})))}async function o(e,t){const r=a(e,t);let s=n.get(r);s||(n.set(r,e()),s=n.get(r));const i=await s;return n.delete(r),i}function a(e,t){return t||(e.name?e:e.toString())}function u(e,t,n){const s={value:t,api:e,timestamp:Date.now()};r.set(a(e,n),s)}async function p(e,n){if(!e)return Promise.resolve(void 0);const s=r.get(a(e,n));if(!t.cacheTimeout||t.cacheTimeout<=0)return await o(e,n);if(!s||s&&s.timestamp&&s.timestamp+t.cacheTimeout<=Date.now()){const t=await o(e,n);return u(e,t,n),i(),t}return i(),Promise.resolve(s.value)}new class{getItemByValue(e,t,r){return Array.isArray(e)?e.find((e=>e[t]===r)):e[t]}async getApiItem(e,t,r,n){const s=await p(e,n);if(s)return this.getItemByValue(s,t,r)}async renderValue(e,t,r,n,s){const i=await this.getApiItem(e,t,r,s);return i?"object"==typeof i?i[n]||"":i||"":""}async renderOptions(e,t,r,n){return(await p(e,n)).map((e=>({label:e[r],value:e[t],key:e[t]})))}};const c=new class{isEmpty(e){return null==e||("string"==typeof e&&""===e.trim()||(!(!Array.isArray(e)||0!==e.length)||"object"==typeof e&&0===Object.keys(e).length))}deepCopy(e){if("object"!=typeof e||null===e)return e;const t=Array.isArray(e)?[]:{};for(const r in e)if(e.hasOwnProperty(r)){const n=e[r];t[r]=Array.isArray(n)?l.deepCopy(e[r]):this.deepCopy(n)}return t}deepAssign(e,...t){if(!t)return e;for(let r of t)if("object"==typeof r)for(const t in r)if(r.hasOwnProperty(t)){const n=r[t];if(null==n)continue;Array.isArray(n)?n&&!Array.isArray(n)?e[t]=l.deepAssign([],r[t]):e[t]=l.deepAssign(e[t]||[],r[t]):"object"!=typeof n?e[t]=n:e[t]&&Array.isArray(e[t])?e[t]=this.deepAssign({},n):e[t]=this.deepAssign(e[t]||{},n)}return e}deepAssignByKey(e,t,...r){return r?(e[t]||(e[t]={}),this.deepAssign(e[t],...r)):e}appendIfNotEmpty(e,t){return this.isEmpty(e)?"":e.toString().concat(t)}};const l=new class{repeat(e,t){return e.join("").repeat(t)}finalItem(e,t){return c.isEmpty(e)?t:e[e.length-1]||t}push(e,t){return Array.isArray(e)&&e.length>=0?(e.push(t),e):[t]}isEmpty(e){return!e||0===e.length}isNotEmpty(e){return!this.isEmpty(e)}defaultIfEmpty(e,t){return this.isEmpty(e)?t:e}fixedUnshift(e,t,...r){e.unshift(...r.reverse());let n=[];return e.length>t&&(n=e.splice(t,e.length-t)),n}fixedPush(e,t,...r){e.push(...r);let n=[];return e.length>t&&(n=e.splice(0,e.length-t)),n}deepCopy(e){return Array.isArray(e)?e.map((e=>Array.isArray(e)?this.deepCopy(e):"object"==typeof e&&null!==e?c.deepCopy(e):e)):[]}deepAssign(e,t){return t&&Array.isArray(t)?t.map(((t,r)=>null==t?e[r]:Array.isArray(t)?e[r]&&!Array.isArray(e[r])?this.deepAssign([],t):this.deepAssign(e[r]||[],t):"object"==typeof t?e[r]&&Array.isArray(e[r])?c.deepAssign({},t):c.deepAssign(e[r]||{},t):t)):e}unique(e,t){const r=[];return e.reduce(((e,n)=>{const s=t?t(n):n;return r.includes(s)||(e.push(n),r.push(s)),e}),[])}intersection(...e){const[t,...r]=e;return this.unique(t.filter((e=>r.every((t=>t.includes(e))))))}union(...e){return this.unique([].concat(...e))}difference(...e){const t=this.intersection(...e);return[].concat(...e).reduce(((e,r)=>(e.includes(r)||t.includes(r)||e.push(r),e)),[])}groupBy(e,t){return e.reduce(((e,r)=>{const n=t(r).toString();return e[n]||(e[n]=[]),e[n].push(r),e}),{})}};new class{LEVEL_NAME="__tree_level";LEVEL_BEGIN=1;BUILT_TAG="__built_tag";buildTree(e,t,r,n,s,i,o){if(!e)return[];let a=l.deepCopy(e);return s=s||this.LEVEL_NAME,this.buildTreeMapper(a,t,r,((e,t,r,o)=>(o!==this.LEVEL_BEGIN&&(t[n]=r),e[s]=o,i&&i(e,t,r,o),e)),o),a}buildCommonTree(e,t,r,n,s,i,o){return this.filterRoot(this.buildTree(e,t,r,n,s,i,o))}filterRoot(e,t){return t=t||this.LEVEL_NAME,e.filter((e=>e[t]===this.LEVEL_BEGIN))}buildTreeMapper(e,t,r,n,s){if(!l.isEmpty(e))for(let i of e){const o=this.LEVEL_BEGIN;if(i[this.BUILT_TAG])return;n&&n(i,null,[],o),this.toTreeMapper(e,i,t,r,n,s,o)}}toTreeMapper(e,t,r,n,s,i,o){const a=[];for(let s of e)s[n]===t[r]&&(s[this.BUILT_TAG]=!0,a.push(s));if(a.length>0)for(let u of a){const p=(o||this.LEVEL_BEGIN-1)+1,c=s?s(u,t,a,p):u;this.toTreeMapper(e,c,r,n,s,i,p)}else i&&i(t)}};return e=e.default})()));